<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/ryangrose/easy-pandoc-templates@948e28e5/css/elegant_bootstrap.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <meta name="author" content="Yoshiyuki Yamagata" />
  <title>2023生物統計学第3回</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">2023生物統計学第3回</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Yoshiyuki
Yamagata</p></li>
                              <li><p class="navbar-text">2023年11月8日</p></li>
                  </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div class="span12">

      
      <h1 id="生物統計演習-第3回-検定">生物統計演習 第3回 検定</h1>
<h2 id="統計的仮説検定検定">統計的仮説検定(検定)</h2>
<p>物事はある確率に従って起こる、と考える場合、その仮説通り起きていると思われる時と、仮説通り起きていなさそうな時がある。例えば、あるさいころでは1の目がほとんど出ない場面に遭遇したとき、何かがおかしいと考える。これは、「さいころは1/6の確率で1の目が出る」という仮説を持っているが、これは観察からその仮説が間違っていると思える何らかの指標が得られたからである。この手続きを統計学的に確立した方法が、<strong>統計的仮説検定
(Statistical hypothesis testing)</strong>(以下、検定)である。</p>
<h3 id="検定の手続き">検定の手続き</h3>
<p>検定は以下の順序でおこなう。 1.
差異は見られない、両者には関係がない、などの保守的な仮説、すなわち<strong>帰無仮説(きむかせつ、Null
hypothesis)</strong> をたてる。<span
class="math inline">\(H_0\)</span>と書く。 2.
帰無仮説に対立する仮説、すなわち <strong>対立仮説 (Alternative
hypothesis)</strong> をたてる。<span
class="math inline">\(H_1\)</span>と書く。 帰無仮説が
<strong>棄却(reject)</strong> された場合に <strong>採択(accept)</strong>
する仮説である。 3.
帰無仮説が正しいと仮定したときに、帰無仮説のもと得られた観察値が観察される確率を計算する。あるいは、<span
class="math inline">\(z\)</span>値、<span
class="math inline">\(t\)</span>値、<span
class="math inline">\(F\)</span>値、<span
class="math inline">\(\chi^2\)</span>値などの
<strong>統計検定量</strong>を計算し、与えられた自由度の元それらの<strong>統計検定量が得られる確率
(<span class="math inline">\(p\)</span>値)</strong>を計算する。 4. <span
class="math inline">\(p\)</span>値と<strong>有意水準<span
class="math inline">\(\mathbf{\alpha}\)</span>値</strong>を比較し、<span
class="math inline">\(p &lt; \alpha\)</span>のとき、<span
class="math inline">\(H_0\)</span>を棄却し、<span
class="math inline">\(H_1\)</span>を採択する。この状態をしばしば
「有意である(Significant)」と表現する。一方、<span
class="math inline">\(p &gt; \alpha\)</span>の場合は<span
class="math inline">\(H_0\)</span>を棄却できない。帰無仮説が棄却できない時、帰無仮説がただしいというわけではなく、帰無仮説が正しくないとは言えない、というレベルでの確信である。</p>
<p><span
class="math inline">\(\alpha\)</span>の値は、通常0.05、0.01などが用いられる。<span
class="math inline">\(\alpha =0.05\)</span>とは、100回に5回は偶然<span
class="math inline">\(p &lt;
\alpha\)</span>となりうることに注意する。</p>
<p>第三回推定の授業にて説明した区間推定の考え方を少し変えることで、検定を行う。</p>
<h3 id="平均値の検定">平均値の検定</h3>
<p>まず最もシンプルなケースから。</p>
<h4 id="例題1分散既知両側検定">例題1(分散既知、両側検定)</h4>
<p>ある業者から購入した培土は、一袋当たり母平均<span
class="math inline">\(\mu=20\)</span>(kg)、母分散<span
class="math inline">\(\sigma=0.21\)</span>にて調整後出荷しているという。最近購入した袋の重さ<span
class="math inline">\(X\)</span>
(kg)を8袋計測したところ、その平均値<span
class="math inline">\(\bar{X}=20.4\)</span>であった。正しく出荷されているか、5%水準で検定せよ。ただし、<span
class="math inline">\(X\)</span>の分散は変わらず<span
class="math inline">\(\sigma=0.21\)</span>とする。</p>
<h4 id="考え方">考え方</h4>
<p><span class="math inline">\(\bar{X}\)</span>の<span
class="math inline">\(X\)</span>の平均値であり、たとえ<span
class="math inline">\(\bar{X}\)</span>が母平均<span
class="math inline">\(\mu=20\)</span>に基づいていても、<span
class="math inline">\(\bar{X}=20\)</span>とピタリ一致しない。中心極限定理から<span
class="math inline">\(X \sim \mathcal{N}(\mu,
\sigma^2)\)</span>のとき、<span class="math inline">\(\bar{X} \sim
\mathcal{N}(\mu, \sigma^2/n)\)</span>である。さらに、標準化スコア <span
class="math display">\[
z = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}}
\]</span> は<span class="math inline">\(z \sim \mathcal{N}(0,
1^2/n)\)</span>である。標準化スコアの区間推定に持ち込むことで、<span
class="math inline">\(\bar{X}\)</span>の確率を求める。</p>
<h3 id="解答例">解答例</h3>
<p>帰無仮説<span class="math inline">\(H_0\)</span>は「培土の母平均は20
である」、対立仮説<span
class="math inline">\(H_1\)</span>は「培土の母平均は20
ではない」として検定を行う。題意から標本平均<span
class="math inline">\(\bar{X}\)</span>は20よりも大きくずれる場合と小さくずれる場合の両方が起こりうるので両側検定である。<span
class="math inline">\(n=8\)</span>、<span
class="math inline">\(\sigma=0.21\)</span>, <span
class="math inline">\(\bar{x}\)</span>=20.4であるから、標準化スコアの公式より、
<span class="math display">\[
z = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} = \frac{20.4 -
20}{0.21/\sqrt{8}} \fallingdotseq 5.34
\]</span></p>
<p>である。両側確率で有意水準5%、すなわち<span
class="math inline">\(Z_{\alpha=0.025} &gt;1.96\)</span>かつ<span
class="math inline">\(Z_{\alpha=0.025} &lt;
-1.96\)</span>である。よって棄却域は<span class="math inline">\(|z| &gt;
1.96\)</span>である。得られた<span
class="math inline">\(z=5.34\)</span>は棄却域にあるため、帰無仮説が正しいとき<span
class="math inline">\(\bar{X}\)</span>が得られる確率は5%より低いと考えられる。したがって、帰無仮説<span
class="math inline">\(H_0\)</span>は棄却され、対立仮説<span
class="math inline">\(H_1\)</span>を採択する。この培土は正しく出荷されていない、と考えられる。</p>
<h4 id="例題2分散既知片側検定">例題2(分散既知、片側検定)</h4>
<p>同様の場合において、<span
class="math inline">\(X\)</span>の母平均は20よりも大きいといえるか、5%水準で検定せよ。
####解答例 帰無仮説<span
class="math inline">\(H_0\)</span>は「培土の母平均は20
である」、対立仮説<span
class="math inline">\(H_1\)</span>は「培土の母平均は20よりも大きい」として検定を行う。題意から標本平均<span
class="math inline">\(\bar{X}\)</span>は20よりも大きくずれる場合を考えるので片側検定である。上記と同様<span
class="math inline">\(z=5.34\)</span>である。片側確率で有意水準5%の棄却域は<span
class="math inline">\(Z_{\alpha=0.05}\)</span> &gt;1.32。得られた<span
class="math inline">\(z=5.34\)</span>は棄却域にあるため、帰無仮説が正しいとき<span
class="math inline">\(\bar{X}\)</span>が得られる確率は5%より低いと考えられる。したがって、帰無仮説<span
class="math inline">\(H_0\)</span>は棄却され、対立仮説<span
class="math inline">\(H_1\)</span>を採択する。この培土は20
kgよりも多いといえる。\</p>
<h3 id="平均値の差の検定-分散未知">平均値の差の検定 (分散未知)</h3>
<h4 id="標本t検定">1標本<span class="math inline">\(t\)</span>検定</h4>
<h4 id="例題">例題</h4>
<p>5頭の大人の豚(成豚)に対して、これまで使用していた飼料が一時的に利用が困難になったため、代替飼料にて飼育を行うよう変更した。5頭の豚について、飼料変更の前後で体重を測定した。新たな飼料は、従来の飼料とくらべて体重に関して影響を与えない飼料と判断できるか。</p>
<table>
<thead>
<tr class="header">
<th>Pig</th>
<th>Weight (kg)</th>
<th>Weight (kg)</th>
<th>Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>Before</td>
<td>After</td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>115</td>
<td>113</td>
<td>-2</td>
</tr>
<tr class="odd">
<td>2</td>
<td>120</td>
<td>122</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>117</td>
<td>118</td>
<td>1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>123</td>
<td>120</td>
<td>-3</td>
</tr>
<tr class="even">
<td>5</td>
<td>125</td>
<td>129</td>
<td>4</td>
</tr>
</tbody>
</table>
<h4 id="考え方-1">考え方</h4>
<p><strong>同じ個体</strong>に何らかの処理をし、処理の前後で観測値の変化を観察することを1標本問題という。その際、処理の前後の変化量<span
class="math inline">\(X\)</span>について検定を行うことが一般的である。観測データから処理前後の個体別のデータが得られているはずなので、<span
class="math inline">\(X\)</span>についての平均と標本不偏分散を計算する。処理に効果がなければ、<span
class="math inline">\(X\)</span>は0に近いはずであるし、意味があれば0からかけ離れたプラスあるいはマイナスの値が得られるはずである。帰無仮説<span
class="math inline">\(H_0\)</span>で<span
class="math inline">\(\bar{X}=0\)</span>を仮定し、その仮定の下、観測データが得られる確率に基づき、統計的判断を行う。ただし、母集団の分散は未知なので、標本不偏分散にて代替した場合、正規分布の代わりに<span
class="math inline">\(t\)</span>分布を用いることは前回述べた。</p>
<h4 id="解答例-1">解答例</h4>
<p>試料を変更後の体重から変更前の体重を引いた差を観測データ<span
class="math inline">\(X\)</span>とおく。観測データの母平均を<span
class="math inline">\(\mu\)</span>とし、帰無仮説<span
class="math inline">\(H_0\)</span>:飼料の変更は成豚の体重に変化を与えない(<span
class="math inline">\(\mu=0\)</span>)、対立仮説<span
class="math inline">\(H_1\)</span>:
飼料の変更は成豚の体重に変化を与える(<span class="math inline">\(\mu
\neq 0\)</span>)として両側検定を行う。<span class="math inline">\(X =
\{-2, 2, 1, -3, -4\}\)</span>の標本平均<span
class="math inline">\(\bar{X}\)</span>は0.4、標本不偏分散<span
class="math inline">\(s^2\)</span>は8.3である。<span
class="math inline">\(H_0\)</span>における<span
class="math inline">\(t\)</span>統計量は <span class="math display">\[
t = \frac{\bar{X} - \mu }{s/\sqrt{n}} = \frac{0.4 -
0}{\sqrt{8.3}/\sqrt{5}} = 0.3104602
\]</span>
両側確率で有意水準5%、自由度4のt分布における棄却域を求める。<span
class="math inline">\(t_{\alpha=0.025, t=4} &gt;-2.78\)</span>かつ<span
class="math inline">\(t_{\alpha=0.975, t=4} &lt;
2.78\)</span>である。よって棄却域は<span class="math inline">\(|t| &gt;
2.78\)</span>である。得られた<span
class="math inline">\(t=0.3104602\)</span>は棄却域に含まれない。したがって、帰無仮説<span
class="math inline">\(H_0\)</span>は5%有意水準で棄却されない。飼料の変更は成豚の体重に変化を与えるとはいえないと考えらえる。\</p>
<h4 id="matlab">MATLAB</h4>
<p>MATLABを使って演習を行う。</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a># データを<span class="va">xに代入</span>。</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">=</span> [<span class="op">-</span><span class="fl">2</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span> <span class="op">-</span><span class="fl">3</span><span class="op">,</span> <span class="fl">4</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 平均</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">% 標本不偏分散</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="va">var</span>(<span class="va">x</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fl">8.3</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">% t 統計量を計算</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="va">t_value</span> <span class="op">=</span> <span class="va">mean</span>(<span class="va">x</span>) <span class="op">/</span> ( <span class="va">sqrt</span>( <span class="va">var</span>(<span class="va">x</span>) ) <span class="op">/</span> <span class="va">sqrt</span>(<span class="fl">5</span>) )</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3105</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">% 自由度4のt分布における　有意水準5% / 2 = 2.5%だから、</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">% t分布における2.5%下側信頼限界は</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="va">tinv</span>(<span class="fl">0.025</span><span class="op">,</span> <span class="fl">4</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">2.776445</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">% t分布における2.5%上側側信頼限界は</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="va">tinv</span>(<span class="fl">0.975</span><span class="op">,</span> <span class="fl">4</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fl">2.776445</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">% ttest()関数で計算 平均=0 を帰無仮説とする</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>[<span class="va">h</span><span class="op">,</span><span class="va">p</span><span class="op">,</span><span class="va">ci</span><span class="op">,</span><span class="va">stats</span>] <span class="op">=</span> <span class="va">ttest</span>(<span class="va">x</span><span class="op">,</span> <span class="fl">0</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="va">h</span> <span class="op">=</span><span class="fl">0</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="fl">0.7717</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="va">ci</span> <span class="op">=-</span><span class="fl">3.1772</span>    <span class="fl">3.9772</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="va">stats</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="va">tstat</span><span class="op">:</span> <span class="fl">0.3105</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>       <span class="va">df</span><span class="op">:</span> <span class="fl">4</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>       <span class="va">sd</span><span class="op">:</span> <span class="fl">2.8810</span></span></code></pre></div>
<p>hは帰無仮説(<span
class="math inline">\(H_0\)</span>)が採択された場合は0, 対立仮説(<span
class="math inline">\(H_1\)</span>)が採択された場合は1となる。
pは帰無仮説(H0)のもと、データが得られるt値よりも大きいtが得られる確率である。この値が有意水準alpha
= 0.05より小さい場合、h=1となり、対立仮説が採択される。</p>
<h3 id="標本t検定-1">2標本<span
class="math inline">\(t\)</span>検定</h3>
<p>品種Aと品種Bの収量試験を行った。品種Aは<span
class="math inline">\(A=\{507.1, 511.1, 509.6, 513.4, 497.8,
508.7\}\)</span> kg/10aであった。一方、品種Bは<span
class="math inline">\(B=\{517.2, 477.4, 500.7, 493.4, 472.1,
503.4\}\)</span>
kg/10aであった。両品種間には差があるといえるか。ただし品種Aと品種Bの収量の母分散は等しいと仮定する。</p>
<h4 id="考え方-2">考え方</h4>
<p><span
class="math inline">\(t\)</span>検定は比較する二者間に「対応がある」か、「対応がない」かの違いで、1標本<span
class="math inline">\(t\)</span>検定と2標本<span
class="math inline">\(t\)</span>検定に分かれる。今回はサンプルは異なるから、二標本<span
class="math inline">\(t\)</span>検定である。1標本<span
class="math inline">\(t\)</span>検定では、比較する二者の差をそれぞれ取り出し、差が0を仮定してもこのようなデータが得られるか。2標本<span
class="math inline">\(t\)</span>検定では、比較する二者間の平均値の差を取り出し、差が0を仮定してもこのようなデータが得られるかを確率計算する。</p>
<p><img src="wxsatn.png" alt="" width="50%"></p>
<p><strong>図. 1標本<span
class="math inline">\(t\)</span>検定と2標本<span
class="math inline">\(t\)</span>検定の違い</strong></p>
<p><span class="math inline">\(A\)</span>および<span
class="math inline">\(B\)</span>の標本平均を<span
class="math inline">\(\bar{A}\)</span>および<span
class="math inline">\(\bar{B}\)</span>とおいたとき、第二回演習にて学習した中心極限定理から<span
class="math inline">\(\bar{A} \sim \mathcal{N}(\mu_A,
\sigma_A^2/m)\)</span>および<span class="math inline">\(\bar{B} \sim
\mathcal{N}(\mu_B,
\sigma_B^2/n)\)</span>であるので、期待値の性質から、<span
class="math inline">\(\bar{A} - \bar{B} \sim \mathcal{N}(\mu_A - \mu_B,
\sigma_A^2/m+\sigma_B^2/n)\)</span>である。
これらの値を利用して標準化スコア<span
class="math inline">\(z\)</span>を計算する。しかし母分散は未知だから、標本不偏分散にて代替したとしよう。その場合は<span
class="math inline">\(z\)</span>は正規分布に従わず、<span
class="math inline">\(t\)</span>分布に従う。標本不偏分散は、<span
class="math inline">\(\sigma_A^2/m\)</span>と<span
class="math inline">\(\sigma_B^2/n\)</span>から算出した合併した分散
(poolded variance)である。 得られた<span
class="math inline">\(t\)</span>分布における信頼区間を棄却域と比較すれば検定できる。</p>
<h4 id="解答例-2">解答例</h4>
<p>帰無仮説<span class="math inline">\(H_0\)</span>は、<span
class="math inline">\((\mu_{A} - \mu_{B})
=0\)</span>であり、対立仮説<span
class="math inline">\(H_1\)</span>は<span class="math inline">\((\mu_{A}
- \mu_{B}) \neq
0\)</span>として検定を行う。AおよびBの分散は等しい、すなわち<span
class="math inline">\(\sigma_A^2 = \sigma_B^2 =
\sigma^2\)</span>であるから、 <span class="math display">\[
z = \frac{(\bar{A} - \bar{B}) - (\mu_A -
\mu_B)}{\sqrt{\sigma_A^2/m+\sigma_B^2/n}}  \quad (\because
\text{標準化の定義より}) \\
     = \frac{(\bar{A} - \bar{B}) - (\mu_A -
\mu_B)}{\sqrt{(1/m+1/n)\sigma^2}} \\
\]</span> ここで、<span class="math inline">\(A\)</span>と<span
class="math inline">\(B\)</span>の標本分散を合併した分散を考え、<span
class="math inline">\(s_p^2\)</span>とおくと、 <span
class="math display">\[
s_p^2 = \frac{ \sum_{i=1}^{m}(A_i - \bar{A})^2 + \sum_{j=1}^{n}(B_j -
\bar{B})^2 } {(m-1) + (n-1)} \quad (\because
\text{合併した分散の定義より})\\
\]</span> <span class="math inline">\(\sigma^2\)</span>を<span
class="math inline">\(s_p^2\)</span>にて代替した場合、 <span
class="math display">\[
t = \frac{(\bar{A} - \bar{B}) - (\mu_A - \mu_B)}{\sqrt{(1/m+1/n) s_p^2}}
\\
\]</span> 得られた<span
class="math inline">\(t\)</span>統計量は自由度<span
class="math inline">\((m-1) + (n-1)\)</span>の<span
class="math inline">\(t\)</span>分布に従う。</p>
<p>以降は1標本<span
class="math inline">\(t\)</span>検定にて行った信頼区間の推定とほぼ同じなので、説明は割愛する。</p>
<h4 id="matlabでの計算">MATLABでの計算</h4>
<p>Rを使って二標本t検定 (等分散性を仮定)を行う。</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="op">=</span> [<span class="fl">507.1</span><span class="op">,</span> <span class="fl">511.1</span><span class="op">,</span> <span class="fl">509.6</span><span class="op">,</span> <span class="fl">513.4</span><span class="op">,</span> <span class="fl">497.8</span><span class="op">,</span> <span class="fl">508.7</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="va">B</span> <span class="op">=</span> [<span class="fl">517.2</span><span class="op">,</span> <span class="fl">477.4</span><span class="op">,</span> <span class="fl">500.7</span><span class="op">,</span> <span class="fl">493.4</span><span class="op">,</span> <span class="fl">472.1</span><span class="op">,</span> <span class="fl">503.4</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">% ttest2()関数で計算</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>[<span class="va">h</span><span class="op">,</span><span class="va">p</span><span class="op">,</span><span class="va">ci</span><span class="op">,</span><span class="va">stats</span>] <span class="op">=</span> <span class="va">ttest2</span>(<span class="va">A</span><span class="op">,</span><span class="va">B</span><span class="op">,</span><span class="ss">&#39;Vartype&#39;</span><span class="op">,</span><span class="ss">&#39;equal&#39;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="va">h</span> <span class="op">=</span><span class="fl">0</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="fl">0.0836</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="va">ci</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2.2209</span>   <span class="fl">30.0542</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="va">stats</span> <span class="op">=</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">tstat</span><span class="op">:</span> <span class="fl">1.9215</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>       <span class="va">df</span><span class="op">:</span> <span class="fl">10</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>       <span class="va">sd</span><span class="op">:</span> <span class="fl">12.5446</span></span></code></pre></div>
<p>t統計量は1.92であった。自由度10におけるp値は0.083であり、5%水準で有意ではない。したがって<span
class="math inline">\(H_0\)</span>は棄却されず、判断を保留する。品種Aと品種Bの収量については有意差があるとは言えない。</p>
<h4 id="標本t検定-等分散性を仮定しない場合">2標本<span
class="math inline">\(t\)</span>検定 (等分散性を仮定しない場合)</h4>
<p>等分散性を仮定しない場合はWelch (ウェルチ)の近似を行った<span
class="math inline">\(t\)</span>検定を行う。</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">% ttest2()関数で計算</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>[<span class="va">h</span><span class="op">,</span><span class="va">p</span><span class="op">,</span><span class="va">ci</span><span class="op">,</span><span class="va">stats</span>] <span class="op">=</span> <span class="va">ttest2</span>(<span class="va">A</span><span class="op">,</span><span class="va">B</span><span class="op">,</span><span class="ss">&#39;Vartype&#39;</span><span class="op">,</span><span class="ss">&#39;unequal&#39;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="va">h</span> <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="fl">0.1029</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="va">ci</span> <span class="op">=</span> <span class="op">-</span><span class="fl">3.7933</span>   <span class="fl">31.6266</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="va">stats</span> <span class="op">=</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">tstat</span><span class="op">:</span> <span class="fl">1.9215</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>       <span class="va">df</span><span class="op">:</span> <span class="fl">6.0170</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>       <span class="va">sd</span><span class="op">:</span> [<span class="fl">5.4158</span> <span class="fl">16.8939</span>]</span></code></pre></div>
<h2 id="離散変数の検定">離散変数の検定</h2>
<p>離散分布をとる確率変数、例えば生存/死亡、成功/失敗などの二値データ、あるいは個数などの整数をとる変数の場合について考える。状況に応じて検定の呼び名あるいは検定法が異なるので、下図に整理した。</p>
<p><img src="qurx2z.png" alt="" width="50%"></p>
<p><strong>図. 個数データに関する検定法の整理 </strong></p>
<p><img src="ogx960k.png" alt="" width="50%"></p>
<p><strong>図. 適合度検定と独立性検定の考え方の違い </strong></p>
<h3 id="適合度検定">適合度検定</h3>
<h4 id="二項検定">二項検定</h4>
<p>コイントスの表と裏、生存/死亡、成功/失敗のように二つの選択肢がある期待頻度で起こる場合がある。観察頻度が期待頻度に適合しているかを
検定することを{}という。\</p>
<h4 id="二項検定の例題">二項検定の例題</h4>
<p>東京付近ではナミテントウムシの翅鞘(ししょう)の斑紋で斑型のしめる比率は3.9%であるという。ある地域において80個体の斑紋型を調べたところ
7個体が斑型、のこりはすべてほかの型であることが分かった。斑型が3.9%という比率に従っていれば、$80
= 3.12 <span
class="math inline">\(個体得られるはずである。この集団も斑型が3.9\%という比率に従っているといえるだろうか。有意水準\)</span>%$で検定せよ。</p>
<h4 id="解説">解説</h4>
<p>80回の試行(<span class="math inline">\(n=80\)</span>)において、<span
class="math inline">\(0.039\)</span>の確率で斑型が7個体、<span
class="math inline">\(1-0.039 = 0.961\)</span>の確率でほかの型が<span
class="math inline">\(80 - 7 = 73\)</span>個体であったので、 <span
class="math display">\[
     P(O_1=7) = \cfrac{80!}{73!  \cdot 7! } \cdot  0.039^{7} \cdot
0.961^{73}
\]</span> となる。$0.039^{7} ^{73} <span
class="math inline">\(はイメージしやすい。80回の試行のうち、7個体斑型の個体が得られるパターンは\)</span>{}<em>{80}
C</em>{7} = 80! / (73! !)$通りある。これを二項確率と言う。</p>
<p>一般的に、事象1がおこる確率が<span
class="math inline">\(p_1\)</span>、事象2がおこる確率が<span
class="math inline">\(1 - p_1\)</span>のとき、<span
class="math inline">\(n\)</span>回の試行において事象1が起こる回数<span
class="math inline">\(O_1\)</span>が二項分布に従う場合、<span
class="math inline">\(O_1 \sim Bi(n, p)\)</span>と表記し、その確率<span
class="math inline">\(P(O_1)\)</span>は <span class="math display">\[
     P(O_1) = \cfrac{n!}{O_1! (1-O_1)!} \cdot p_1^{O_1} \cdot  (1 -
p_1)^{n - O_1}
\]</span> である。例題では「80個体のうち、斑型の個体数<span
class="math inline">\(O_1\)</span>が<span
class="math inline">\(p_1=0.039\)</span>に従って起こる」を帰無仮説とする。その場合、<span
class="math inline">\(O_1 \sim Bi(80, 0.039)\)</span>と表記する。</p>
<p>調査を行った小集団では、期待される個体数よりも斑型の個体数が多く観察された。よって、斑型の個体が7個体以上になる場合の上側累積確率にて検定を行う。斑型の個体が7個体以上の確率は、<span
class="math inline">\(P(O_1 \geq 7) = P(O_1=7) + P(O_1=8) + P(O_1=9)
+\cdots + P(O_1=80)\)</span>となる。 <span
class="math inline">\(P(O_1)\)</span>の二項分布をRにて図示しよう。</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">% パラメータ設定</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="va">n</span> <span class="op">=</span> <span class="fl">80</span> <span class="co">% 試行数 = さいころをふった数</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">a</span> <span class="op">=</span> <span class="fl">0.039</span>  <span class="co">% ある事象が起こる確率</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span>    <span class="co">% xの範囲</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">% 二項分布の確率密度関数の計算</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="va">pmf</span> <span class="op">=</span> <span class="va">binopdf</span>(<span class="va">x</span><span class="op">,</span> <span class="va">n</span><span class="op">,</span> <span class="va">a</span>)<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">% % X=3にピークを持つ二項分布が得られる。 bar()で棒グラフ作成</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="va">bar</span>(<span class="va">x</span><span class="op">,</span> <span class="va">pmf</span><span class="op">,</span> <span class="ss">&#39;hist&#39;</span>)<span class="op">;</span>   </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="va">title</span>(<span class="ss">&#39;二項分布&#39;</span>)<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">&#39;斑型の個体数&#39;</span>)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">&#39;確率&#39;</span>)<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">% X=6と7の間に赤線を引く。vはvertical (縦)の意味。</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="fl">6.5</span><span class="op">,</span> <span class="ss">&#39;r&#39;</span>)<span class="op">;</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">% 平均値を求める</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="va">mean</span>(<span class="va">pmf</span>)</span></code></pre></div>
<p>上記のスクリプトにより、図に示すようなヒストグラムが得られる。斑型の確率が<span
class="math inline">\(0.039\)</span>なので、80回の試行においては平均的に斑型が3.12個体が得られる確率が最も高いことがわかる。</p>
<p><img src="pewc8toy.png" alt="" width="50%"></p>
<p><strong>図.
ナミテントウムシを80個体調査したときに斑型が出現する回数の二項分布
</strong></p>
<p>題意より、斑型が7個体以上得られる場合を考える。(赤線より右)
二項分布の確率分布関数の累積確率関数(cdf, Cumulative Distribution
Function)はbinocdf(x, n, p)関数である。</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">n</span> <span class="op">=</span> <span class="fl">80</span> <span class="co">% 試行数 = さいころをふった数</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">a</span> <span class="op">=</span> <span class="fl">0.039</span>  <span class="co">% ある事象が起こる確率</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span>    <span class="co">% xの範囲</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">% 二項分布の累積確率関数の計算</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="va">cdf</span> <span class="op">=</span> <span class="va">binocdf</span>(<span class="va">x</span><span class="op">,</span> <span class="va">n</span><span class="op">,</span> <span class="va">a</span>)<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="va">bar</span>(<span class="va">x</span><span class="op">,</span> <span class="va">cdf</span><span class="op">,</span> <span class="ss">&#39;hist&#39;</span>)<span class="op">;</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">%斑型が0から6までが出現する下側累積確率は</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="va">binocdf</span>(<span class="fl">6</span><span class="op">,</span> <span class="va">n</span><span class="op">,</span> <span class="va">a</span>)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9633</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">% よって7回以上出現する確率は</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span> <span class="op">-</span> <span class="va">binocdf</span>(<span class="fl">6</span><span class="op">,</span> <span class="va">n</span><span class="op">,</span> <span class="va">a</span>)<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a> <span class="fl">0.0367</span></span></code></pre></div>
<h4 id="解答例-3">解答例}</h4>
<p>帰無仮説(<span class="math inline">\(H_0\)</span>)と対立仮説(<span
class="math inline">\(H_1\)</span>)を <span class="math display">\[
  H_0 :「斑型のナミテントウムシは0.039の確率で出現する」 \\
  H_1 :「斑型のナミテントウムシは0.039の確率より多く出現する」
(片側検定)\\
\]</span>
とする。ナミテントウムシを80個体調査したとき、斑型の個体は<span
class="math inline">\(H_0\)</span>のもと二項分布にしたがって<span
class="math inline">\(X\)</span>個体得られる(<span
class="math inline">\(X \sim Bi(n=80, p=0.039)\)</span>)とする。</p>
<p>調査の結果、斑型の個体が7個体であり、p=0.039より期待される個体数よりも多かった。したがって検定は小集団における斑型の個体の頻度がp=0.039よりも大きいかを検定するため、上側検定を行う。累積確率<span
class="math inline">\(P(X \geq 7)
=3.7\%\)</span>であった。得られたp値は有意水準<span
class="math inline">\(\alpha
=5\%\)</span>より小さい。したがって、帰無仮説(<span
class="math inline">\(H_0\)</span>)は棄却され、対立仮説(<span
class="math inline">\(H_1\)</span>)を採択する。「斑型のナミテントウムシは0.039の確率より多く出現する」といえる。</p>
<h4 id="階級が3以上の場合">階級が3以上の場合</h4>
<p>階級数が3以上の場合は <strong>多項検定</strong>を用いる。多項確率は
<span class="math display">\[
     P = \cfrac{n!}{O_1! O_2! \cdots O_k!} p_1^{O_1}p_2^{O_2} \cdots
p_k^{O_k}
\]</span> にてあらわす。Rでは多項分布のデフォルトの関数はない。</p>
<h3 id="カイ二乗検定">カイ二乗検定</h3>
<p>階級の数が3つ以上の場合は多項確率を用いて確率の計算を行う。しかし階級(<span
class="math inline">\(k\)</span>)の数が多く、<span
class="math inline">\(n\)</span>が大きいとき、最近のコンピューターでも計算量が膨大になり、計算困難な場合が多い。
その場合、 <span class="math display">\[
     \sum_{i=1}^{k} \frac{(O_i - E_i)^2}{E_i} \sim \chi^2
\]</span> の様な統計量は、自由度<span class="math inline">\(\nu =
k-1\)</span>の<span
class="math inline">\(\chi^2\)</span>分布に収束することが証明されている。カイ二乗分布表あるいはRやエクセルの関数を用いれば、<span
class="math inline">\(\chi^2\)</span>値が得られる確率の近似値を知ることができる。有意水準<span
class="math inline">\(\alpha\)</span>の場合、棄却域を<span
class="math inline">\(\chi^2 &gt; \chi_{\alpha}^2\)</span>(自由度<span
class="math inline">\(k-1\)</span>)として検定を行う。これを{}といい、高速、簡便な方法として用いられる。一方、一つの階級の観察度数が5より小さい階級がある場合、近似が悪いので、<span
class="math inline">\(\chi^2\)</span>検定を用いてはならない。(nが小さいので、二項検定、多項検定、正確確率検定の実行を検討するか、階級をまとめるなどの方法がある。)</p>
<h4 id="例題-1">例題</h4>
<p>ある二倍体生物において、ゲノムのある特定の場所を増幅するPCRプライマー対がある。そのプライマー対にてF2集団100個体のゲノムDNAを鋳型としてPCR増幅を行ったところ、112
bpのバンドのみを示した個体(AA)が31個体、112bpと145
bpのバンドを示した個体(AB)が53個体、145
bpのバンドのみを示した個体(BB)が16個体得られた。この集団ではAA:AB:BB=1:2:1に適合していないといえるか。</p>
<table>
<thead>
<tr class="header">
<th>遺伝子型</th>
<th>AA</th>
<th>AB</th>
<th>BB</th>
<th>計</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>観察度数</td>
<td>31</td>
<td>53</td>
<td>16</td>
<td>100</td>
</tr>
</tbody>
</table>
<h4 id="解答例-4">解答例</h4>
<p>帰無仮説<span
class="math inline">\(H_0\)</span>:「観察された分離頻度は1:2:1に適合している」、対立仮説<span
class="math inline">\(H_1\)</span>:「観察された分離頻度は1:2:1に適合していない」として検定を行う。観察された分離頻度は1:2:1に適合していると仮定し、各階級における期待度数および<span
class="math inline">\(\chi^2\)</span>値をもとめ、<span
class="math inline">\(\chi^2\)</span>値の総和を求める。</p>
<table>
<thead>
<tr class="header">
<th>形態</th>
<th>AA</th>
<th>AB</th>
<th>BB</th>
<th>計</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>観察度数(<span class="math inline">\(O\)</span>)</td>
<td>31</td>
<td>53</td>
<td>16</td>
<td>100</td>
</tr>
<tr class="even">
<td>確率</td>
<td>1/4</td>
<td>1/2</td>
<td>1/4</td>
<td>1</td>
</tr>
<tr class="odd">
<td>期待度数(<span class="math inline">\(E\)</span>)</td>
<td>25</td>
<td>50</td>
<td>25</td>
<td>100</td>
</tr>
<tr class="even">
<td><span class="math inline">\((E-O)^2/E\)</span></td>
<td>1.44</td>
<td>0.18</td>
<td>3.24</td>
<td>4.86</td>
</tr>
</tbody>
</table>
<p><span
class="math inline">\(\chi^2\)</span>の総和は4.86であった。自由度2における5%棄却域は<span
class="math inline">\(\chi^2 = \chi^2_{5\%}(2) =
5.99\)</span>であり、5%有意水準で棄却されたない。ゆえに、帰無仮説は棄却されず、判断を保留する。観察された分離比は1:2:1に適合してないとはいえない。</p>
<h4 id="matlabの出力結果">MATLABの出力結果</h4>
<p>ちょっと難しいのでカンタン関数を作成しました。ここからダウンロードしてください。
https://github.com/qikushu/stat/blob/master/matlab/chisqGofTest.m</p>
<p>ダウンロードしたら、MATLABの現在のフォルダーにドラッグしてインストールしてください。</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">% 観察度数をベクトルで入力</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="va">o</span> <span class="op">=</span>[<span class="fl">31</span><span class="op">,</span> <span class="fl">53</span><span class="op">,</span> <span class="fl">16</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 期待確率をベクトルで入力</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="va">e1</span> <span class="op">=</span> [<span class="fl">0.25</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.25</span>]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">e2</span> <span class="op">=</span> <span class="va">e1</span> <span class="op">*</span> <span class="va">sum</span>(<span class="va">o</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">% chisqTest(期待頻度、観察頻度、有意水準)です。有意水準を省略した場合はalpha= 0.05です。</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>[<span class="va">h</span><span class="op">,</span> <span class="va">p</span><span class="op">,</span><span class="va">st</span>] <span class="op">=</span>  <span class="va">chisqGofTest</span>(<span class="va">e2</span><span class="op">,</span> <span class="va">o</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">h</span> <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="fl">0.0880</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="va">st</span> <span class="op">=</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">chi2stat</span><span class="op">:</span> <span class="fl">4.860</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">df</span><span class="op">:</span> <span class="fl">2</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">% chi2statがカイ二乗totalです。期待頻度(e)において、</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">% この値より大きなカイ二乗値が得られる確率がpです</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">% dfは自由度です。</span></span></code></pre></div>
<p>カイ二乗の総和は4.86であった。カイ二乗値に対する正確なp値が出てくるので、適宜、有意水準に合わせて検定を行ってください。</p>
<h2 id="独立性検定">独立性検定</h2>
<p>二つ(以上)の標本があり、それらのデータが互いに関連しているかを分析する場合、まずは{}あるいは{}と呼ばれる表を作成する。例として、$2
$の分割表を示す。</p>
<h4 id="例題1">例題1</h4>
<p>ある植物の幼苗に核酸類似物質の濃度を二段階(高濃度区と低濃度区)に変えて処理し、花芽促進の有無を調べた。花芽分化の有無は核酸類似物質の濃度区と関係があるか。</p>
<table>
<thead>
<tr class="header">
<th>核酸類似物質</th>
<th>分化あり</th>
<th>分化なし</th>
<th>計</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>高濃度</td>
<td>64</td>
<td>5</td>
<td>69</td>
</tr>
<tr class="even">
<td>低濃度</td>
<td>57</td>
<td>14</td>
<td>71</td>
</tr>
<tr class="odd">
<td>計</td>
<td>121</td>
<td>19</td>
<td>140</td>
</tr>
</tbody>
</table>
<h4 id="考え方-3">考え方</h4>
<p>説明に必要な用語を明確にする。以下の表は$2
$分割表の一般的な書き方である。</p>
<p>$2 $分割表</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(S\)</span></th>
<th><span class="math inline">\(T\)</span></th>
<th>周辺度数 (周辺確率)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(U\)</span></td>
<td><span class="math inline">\(a\)</span></td>
<td><span class="math inline">\(b\)</span></td>
<td><span class="math inline">\(n_U\)</span> (<span
class="math inline">\(p_U = n_U / n_{total}\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(V\)</span></td>
<td><span class="math inline">\(c\)</span></td>
<td><span class="math inline">\(d\)</span></td>
<td><span class="math inline">\(n_V\)</span> (<span
class="math inline">\(p_V = n_V / n_{total}\)</span>)</td>
</tr>
<tr class="odd">
<td>周辺度数 (周辺確率)</td>
<td><span class="math inline">\(n_S\)</span></td>
<td><span class="math inline">\(n_T\)</span> (<span
class="math inline">\(p_T = n_T / n_{total}\)</span>)</td>
<td><span class="math inline">\(n_{total}\)</span></td>
</tr>
</tbody>
</table>
<p>行方向および列方向のセルの合計を{}といい、データU、V (行方向)、S、T
(列方向)の周辺度数は<span class="math inline">\(n_U\)</span>、<span
class="math inline">\(n_V\)</span>、<span
class="math inline">\(n_S\)</span>、<span
class="math inline">\(n_T\)</span>である。ここで、<strong>STおよびUVが独立ならば、各セルの期待確率は周辺確率の積である</strong></p>
<p>SU:TU:SV:TV=<span class="math inline">\(p_S \cdot p_U \cdot
n_{total}\)</span>:<span class="math inline">\(p_T \cdot p_U \cdot
n_{total}\)</span>:<span class="math inline">\(p_S \cdot p_V \cdot
n_{total}\)</span>:<span class="math inline">\(p_T \cdot p_V \cdot
n_{total}\)</span></p>
<p>例題1における各セルの期待値</p>
<table>
<thead>
<tr class="header">
<th>核酸類似物質</th>
<th>分化あり</th>
<th>分化なし</th>
<th>計</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>高濃度</td>
<td>59.6</td>
<td>9.36</td>
<td>69</td>
</tr>
<tr class="even">
<td>低濃度</td>
<td>61.36</td>
<td>9.63</td>
<td>71</td>
</tr>
<tr class="odd">
<td>計</td>
<td>121</td>
<td>19</td>
<td>140</td>
</tr>
</tbody>
</table>
<p><strong>周辺確率から求めた期待度数に対する観察度数の適合度検定が独立性検定</strong>である。適合度検定の一種なので、カイ二乗検定が利用できる。ただし自由度は(列数-1)(行数-1)、すなわち2x2分割表では(2-1)(2-1)=1となる。階級の数はSU,
TU, SV,
TVの4つであるが、SあるいはTの二つの選択肢とUあるいはVの二つの選択肢の組み合わせであるからである。</p>
<h4 id="matlab用いた解析の例">MATLAB用いた解析の例</h4>
<p>帰無仮説(<span
class="math inline">\(H_0\)</span>)を「花芽分化の有無は核酸類似物質の濃度区と関係がある」、対立仮説を「花芽分化の有無は核酸類似物質の濃度区と関係がない」として検定を行う。2
x 2の分割表についてカイ二乗検定による独立性検定を行う。</p>
<p>これもカンタン関数を作成しました。ここからダウンロードしてください。
https://github.com/qikushu/stat/blob/master/matlab/chisqIndTest.m</p>
<p>ダウンロードしたら、MATLABの現在のフォルダーにドラッグしてインストールしてください。さきほどのchisqGofTest.mが必要です。</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">% 分割表 (crosstab)の行列を作成</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="va">mat</span> <span class="op">=</span> [<span class="fl">64</span><span class="op">,</span> <span class="fl">5</span><span class="op">;</span> <span class="fl">57</span><span class="op">,</span> <span class="fl">14</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">64</span>     <span class="fl">5</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fl">57</span>    <span class="fl">14</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">% 独立性検定をchisqIndTest()にて実行</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>[<span class="va">p</span><span class="op">,</span> <span class="va">df</span><span class="op">,</span> <span class="va">chi2</span>] <span class="op">=</span> <span class="va">chisqIndTest</span>(<span class="va">mat</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span>  <span class="fl">0.0312</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="va">df</span> <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="va">chi2</span> <span class="op">=</span> <span class="fl">4.6405</span></span></code></pre></div>
<p>以上の結果、核酸類似物質の濃度区と花芽分化の有無を独立と仮定した場合のカイ二乗値4.6405が得られた。自由度(2-1)
x (2-1) = 1のカイ二乗分布における片側累積確率が5%以下となる棄却域は<span
class="math inline">\(\chi^2_{\alpha=0.05} &gt;
3.84\)</span>である。計算の結果、より正確には、<span
class="math inline">\(p=0.0312 &gt;
5\)</span>%であり、帰無仮説は棄却される。したがって、花芽分化の有無は核酸類似物質の濃度区と関係があることが示唆される。</p>
<h4 id="フィッシャーの正確確率検定">フィッシャーの正確確率検定</h4>
<p>前述のとおり、<span
class="math inline">\(\chi^2\)</span>検定では、<span
class="math inline">\(n\)</span>が多いときに<span
class="math inline">\((E-O)^2/O\)</span>が<span
class="math inline">\(\chi^2\)</span>分布に従う特性を利用した。<span
class="math inline">\(n\)</span>が小さい場合や1つのセルの期待度数が5より小さい場合は利用できない。この場合は階級をまとめて<span
class="math inline">\(\chi^2\)</span>検定を行うか、{}を用いる。フィッシャーの正確確率検定は、<code>fisher.test()</code>関数をもちいる。</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>[<span class="va">h</span><span class="op">,</span><span class="va">p</span><span class="op">,</span><span class="va">stats</span>] <span class="op">=</span> <span class="va">fishertest</span>(<span class="va">mat</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="va">h</span> <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="fl">0.0467</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="va">stats</span> <span class="op">=</span> <span class="va">OddsRatio</span><span class="op">:</span> <span class="fl">3.1439</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">ConfidenceInterval</span><span class="op">:</span> [<span class="fl">1.0658</span> <span class="fl">9.2735</span>]</span></code></pre></div>
<p>正確確率では、<span class="math inline">\(p=
0.0467&lt;0.05\)</span>となり、有意水準<span
class="math inline">\(\alpha=0.05\)</span>より低い<span
class="math inline">\(p\)</span>値が得られた。この結果から、帰無仮説が棄却される。花芽分化の有無は核酸類似物質の濃度区と関係がある、と推察される。サンプル数が少ないセルがあると、p値の算出に影響を与える。</p>
<h4 id="例題2-k-times-l分割表">例題2 (<span class="math inline">\(k
\times l\)</span>分割表)</h4>
<p>中村(1972)の調査によると、(「土壌動物の生態と観察」p119-121より)、4種類の利用状況の異なる草地におけるいろいろなグループに属するダニの個体数(4,
6, 8, 10, 1,
3月の合計は以下の表のようである。草地によってダニのグループ間における個体数の割合に差があるといえるか</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>無気門</th>
<th>異気門</th>
<th>前気門</th>
<th>中気門</th>
<th>ササラ</th>
<th>合計</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>放牧・新播区</td>
<td>2</td>
<td>139</td>
<td>72</td>
<td>17</td>
<td>97</td>
<td>327</td>
</tr>
<tr class="even">
<td>放牧・旧播区</td>
<td>2</td>
<td>167</td>
<td>35</td>
<td>16</td>
<td>86</td>
<td>306</td>
</tr>
<tr class="odd">
<td>牧草・新播区</td>
<td>0</td>
<td>97</td>
<td>25</td>
<td>39</td>
<td>273</td>
<td>433</td>
</tr>
<tr class="even">
<td>牧草・旧播区</td>
<td>10</td>
<td>110</td>
<td>22</td>
<td>23</td>
<td>363</td>
<td>528</td>
</tr>
<tr class="odd">
<td>合計</td>
<td>14</td>
<td>512</td>
<td>154</td>
<td>95</td>
<td>819</td>
<td>1594</td>
</tr>
</tbody>
</table>
<p>上記の例は<span class="math inline">\(4 \times
5\)</span>の分割表の例である。
まずエクセルに打ち込んだ後コピーする。</p>
<p><img src="m9eyu07.png" alt="" width="50%"></p>
<p><strong>図. エクセルからのデータの読み込み法1</strong></p>
<p>ここからコピーしてエクセルに張り付けてもいいです。
https://raw.githubusercontent.com/qikushu/stat/master/mite.txt</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">% まずからの行列を作成する</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="va">bb</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 右側のワークスペースからbbを探してダブルクリックしてエディターを開く</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">% 左上つめて、ペーストする</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">% カイ二乗による独立性検定</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>[<span class="va">p</span><span class="op">,</span> <span class="va">df</span><span class="op">,</span> <span class="va">chi2</span>] <span class="op">=</span> <span class="va">chisqIndTest</span>(<span class="va">bb</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="va">p</span> <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="va">df</span> <span class="op">=</span><span class="fl">12</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="va">chi2</span> <span class="op">=</span> <span class="fl">282.9120</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">% 正確確率検定はエラー</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>[<span class="va">h</span><span class="op">,</span><span class="va">p</span><span class="op">,</span><span class="va">stats</span>] <span class="op">=</span> <span class="va">fishertest</span>(<span class="va">bb</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">%次を使用中のエラー: fishertest</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">%FISHERTEST には 2 行 2 列の行列またはテーブル X が必要です。</span></span></code></pre></div>
<p>fishertestはエラーとなる。これは2x2以上の分割表にて個体数が多すぎる場合、計算量が膨大になるためである。また、期待度数が5以下などの低いセルが存在するときは、階級をまとめる。ここでは、無気門
+ 異気門としよう(表<span
class="math inline">\(\ref{tb:7O7TN781}\)</span> )。</p>
<p><strong>表
データ数が少ないセルをこみにして作成しなおした分割表</strong></p>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 9%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>無気門 + 異気門</th>
<th>前気門</th>
<th>中気門</th>
<th>ササラ</th>
<th>合計</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>放牧・新播区</td>
<td>141</td>
<td>72</td>
<td>17</td>
<td>97</td>
<td>327</td>
</tr>
<tr class="even">
<td>放牧・旧播区</td>
<td>169</td>
<td>35</td>
<td>16</td>
<td>86</td>
<td>306</td>
</tr>
<tr class="odd">
<td>牧草・新播区</td>
<td>97</td>
<td>25</td>
<td>39</td>
<td>273</td>
<td>433</td>
</tr>
<tr class="even">
<td>牧草・旧播区</td>
<td>120</td>
<td>22</td>
<td>23</td>
<td>363</td>
<td>528</td>
</tr>
<tr class="odd">
<td>合計</td>
<td>526</td>
<td>154</td>
<td>95</td>
<td>819</td>
<td>1594</td>
</tr>
</tbody>
</table>
<p>ここからコピーしてエクセルに張り付けてもいいです。
https://raw.githubusercontent.com/qikushu/stat/master/mite.txt</p>
<p>このデータにて独立性検定を行う。サンプル数が十分あるので、カイ二乗検定にて行う。</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="va">cc</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">% データをペースト</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">p</span><span class="op">,</span> <span class="va">df</span><span class="op">,</span> <span class="va">chi2</span>] <span class="op">=</span> <span class="va">chisqIndTest</span>(<span class="va">cc</span>)</span></code></pre></div>
<p>以上の計算結果より、以下のような文章の作成が求められる。帰無仮説(<span
class="math inline">\(H_0\)</span>)を「どの草地区においてもダニ類の各グループに属する個体数の全個体数に対する比率は等しい」、対立仮説(<span
class="math inline">\(H_1\)</span>)を「どの草地区においてもダニ類の各グループに属する個体数の全個体数に対する比率は等しくない」とする。<span
class="math inline">\(H_0\)</span>のもと、草地区の数を4、ダニ類の各グループ数を4とした<span
class="math inline">\(4 \times 4\)</span>の分割表を作成し、<span
class="math inline">\(\chi^2\)</span>値を求めたところ、277.83であった。自由度は、(4-1)(4-1)=9であるため、自由度9における<span
class="math inline">\(\chi^2\)</span>分布に基づいて<span
class="math inline">\(p\)</span>値を求めたところ、<span
class="math inline">\(p&lt;2.2e-16\)</span>であった。これは有意水準5%より小さい。以上の結果から、帰無仮説を棄却し、対立仮説を採択する。「どの草地区においてもダニ類の各グループに属する個体数の全個体数に対する比率は等しくない」</p>
<h2 id="第三回演習のレポート課題">第三回演習のレポート課題</h2>
<p>下記の検定結果をレポートとしてまとめて提出すること。その際、(Point
1)帰無仮説と対立仮説を示しなさい。(Point 2)統計量を示し、(Point
3)片側確率あるい両側確率のどちらの棄却域を 用いかを明らかにし、(Point 4)
p値を求めなさい。(Point 5)
p値に基づいて帰無仮説が採択されたのか、棄却されたのかを明示しなさい結論も書くこと。計算にはRを用いてもよろしい。Rを用いた場合は、コードも記載すること。正規分布表、<span
class="math inline">\(ｔ\)</span>分布表、<span
class="math inline">\(\chi^2\)</span>分布表などは 適宜活用すること。</p>
<ol type="1">
<li><p><strong>(平均値の検定、母分散(<span
class="math inline">\(\sigma\)</span>)は既知)</strong>
小麦粉を袋に詰める機械は、<span
class="math inline">\(\mu=200\)</span>g、<span
class="math inline">\(\sigma=10\)</span>gの正規分布に従うように調整されている。10個の袋の無作為標本をとって重量を測定したところ、平均<span
class="math inline">\(\bar{x}\)</span>は202.4gであった。この機械は正しく調整されているか、5%有意水準で検定せよ。</p></li>
<li><p><strong>(小標本、平均値の差の検定、母分散は未知で等しいと考えない)</strong>
培養細胞にsiRNA処理を行った区と行っていない区における、あるタンパク質の発現量を調査した。処理区12サンプル(<span
class="math inline">\(X=\{X_1, X_2 , \cdots , X_{12}\},
n_1=12\)</span>)では質量の平均が12.2 μg/g、標準偏差が1.2
μg/gで、未処理区10サンプル(<span class="math inline">\(Y=\{Y_1, Y_2 ,
\cdots , Y_{10}\},n_2=10\)</span>)では平均が9.9 μg/g、標準偏差が0.8
μg/gであった。処理による差があるといえるか、5%有意水準で検定せよ。ただし、処理区と未処理区の標準偏差は等しくないと仮定すること。</p></li>
</ol>
<p>補足: ただし未知の母平均<span class="math inline">\(\mu_{X} =
\mu_{Y}\)</span>を仮定の下、<span
class="math inline">\(t\)</span>分布は、 <span class="math display">\[
    t = \frac{(\bar{X}-\bar{Y}) - (\mu_{X} - \mu_{Y})}{\sqrt{s_1^2/n_1 +
s_2^2/n_2}} = \frac{(\bar{X}-\bar{Y})}{\sqrt{s_1^2/n_1 + s_2^2/n_2}}
\]</span> にて求め、近似的に自由度が <span class="math display">\[
    \nu = \cfrac{\left( \cfrac{s_1^2}{n_1} + \cfrac{s_2^2}{n_2}
\right)^2}{\cfrac{(s_1^4/n_1)^2}{n_1-1}+\cfrac{(s_2^4/n_2)^2}{n_2-1}}
\]</span> に最も近い整数<span
class="math inline">\(\nu^*\)</span>(ニュー、スターと読む)の<span
class="math inline">\(t\)</span>分布<span
class="math inline">\(t(\nu^*)\)</span>に従うとする
(ウェルチの近似法)。</p>
<p>「(Point 4) p値を求めなさい。」は求めなくてもよい。(挑戦したい人:
もとめた<span class="math inline">\(t\)</span>を<span
class="math inline">\(t=t*\)</span> とおくと、 <span
class="math inline">\(-t* &lt; t &lt; t*\)</span>における<span
class="math inline">\(t\)</span>分布の累積確率にて求まる。その場合は下側累積確率を求めるpt()関数をもちいて、t分布の左右対称性を利用して求める。図を書けばわかるはず。)</p>
<ol start="3" type="1">
<li><strong>(小標本、平均値の差の検定 (対応あり)</strong>
午前と午後で昆虫の探索行動
(m(メートル))に差があるかを調べるため、ビデオ撮影を行い歩行距離の積算データを得た。10頭の昆虫を供試した。結果、下記のような結果を得た。5%水準で差があるといえるか。</li>
</ol>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th>昆虫</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>午前</td>
<td>1.3</td>
<td>1.5</td>
<td>1.4</td>
<td>1.5</td>
<td>1.1</td>
<td>1.4</td>
<td>0.7</td>
<td>1.1</td>
<td>1.5</td>
<td>1.5</td>
</tr>
<tr class="even">
<td>午後</td>
<td>2.0</td>
<td>1.6</td>
<td>1.5</td>
<td>2.0</td>
<td>1.4</td>
<td>1.1</td>
<td>2.2</td>
<td>1.2</td>
<td>1.4</td>
<td>1.1</td>
</tr>
</tbody>
</table>
<ol start="4" type="1">
<li><strong>(適合度検定)</strong> 葉面を1 cm x 1
cm個の区画に分割し、1区画当たりの病変のスポット数を計測した。 100
区画について調査をしたところ、次のデータが得られた。<span
class="math inline">\(\lambda=2.2\)</span>のポアソン分布に従うという帰無仮説のもと、期待度数を算出した。観察データは期待度数に5%水準で適合しているといえるか。セル数が少ないクラスは混みにしましょう。6と7以上は合わせましょう。</li>
</ol>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th>病変スポットの数</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7 以上</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>観察度数</td>
<td>29</td>
<td>23</td>
<td>21</td>
<td>14</td>
<td>6</td>
<td>9</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>期待度数</td>
<td>11.08</td>
<td>24.38</td>
<td>26.81</td>
<td>19.66</td>
<td>10.82</td>
<td>4.76</td>
<td>1.74</td>
<td>0.75</td>
</tr>
</tbody>
</table>
<ol start="5" type="1">
<li><strong>(独立性検定)</strong>
ある昆虫について人工飼料の種類によって、産卵行動と産卵行動に関連があるかを調査した。2
x 4分割表を用いた独立性検定により5%水準で差があるといえるか。</li>
</ol>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="header">
<th>蔵卵行動</th>
<th>人工飼料A</th>
<th>人工飼料B</th>
<th>人工飼料C</th>
<th>人工飼料D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>蔵卵個体数</td>
<td>89</td>
<td>60</td>
<td>57</td>
<td>29</td>
</tr>
<tr class="even">
<td>非蔵卵個体数</td>
<td>45</td>
<td>14</td>
<td>70</td>
<td>26</td>
</tr>
</tbody>
</table>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
