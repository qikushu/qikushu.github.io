<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/ryangrose/easy-pandoc-templates@948e28e5/css/elegant_bootstrap.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <meta name="author" content="Yoshiyuki Yamagata" />
  <title>2023生物統計学第4回</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">2023生物統計学第4回</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Yoshiyuki
Yamagata</p></li>
                              <li><p class="navbar-text">2023年11月9日</p></li>
                  </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div class="span12">

      
      <h1 id="生物統計演習-第4回-分散分析">生物統計演習 第4回
分散分析</h1>
<h2 id="分散分析">分散分析</h2>
<p>第三回「検定」では、二つのグループ間の平均値の差の検定を行う際、<span
class="math inline">\(t\)</span>検定を用いることを説明した。二者間の比較は対比較
(paired test)と呼ぶが、比較したいグループが三つ、例えばAグループ,
Bグループ,
Cグループ、になった場合、AとB、BとC、CとAの比較を行う必要がある。この際検定の多重性の問題が生ずる。三者以上の比較を行う場合は、
<strong>多重比較</strong> か、<strong>分散分析(Analysis of variance
(ANOVA)</strong>
を行う。まず分散分析を行い、有意であった場合は、多重比較による群間の差の検定に進むのが常套手段である。これを事後解析(post
hoc analysis)という。post
hoc解析は次の演習で行う。多重比較と分散分析の使い分けは、状況による。
https://www.jstage.jst.go.jp/article/kagakutoseibutsu/51/7/51_483/_pdf<br />
にその説明が詳しい。</p>
<h3 id="一元配置分散分析">一元配置分散分析</h3>
<p>三種類の有機肥料を三種類の区画に投入し、イネの収量を調査した(表)。肥料および栽培区画は収量に影響を与えているといえるか。5%水準で検定せよ。</p>
<p><strong>表. 収量試験</strong></p>
<table>
<thead>
<tr class="header">
<th>肥料(Fertilizer)</th>
<th>区画(Area)</th>
<th>収量 (kg/ha)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>D</td>
<td>514.7</td>
</tr>
<tr class="even">
<td>A</td>
<td>D</td>
<td>509.1</td>
</tr>
<tr class="odd">
<td>A</td>
<td>E</td>
<td>512.2</td>
</tr>
<tr class="even">
<td>A</td>
<td>E</td>
<td>532.7</td>
</tr>
<tr class="odd">
<td>A</td>
<td>F</td>
<td>517.7</td>
</tr>
<tr class="even">
<td>A</td>
<td>F</td>
<td>522.2</td>
</tr>
<tr class="odd">
<td>B</td>
<td>D</td>
<td>503.5</td>
</tr>
<tr class="even">
<td>B</td>
<td>D</td>
<td>511.0</td>
</tr>
<tr class="odd">
<td>B</td>
<td>E</td>
<td>525.1</td>
</tr>
<tr class="even">
<td>B</td>
<td>E</td>
<td>504.9</td>
</tr>
<tr class="odd">
<td>B</td>
<td>F</td>
<td>524.4</td>
</tr>
<tr class="even">
<td>B</td>
<td>F</td>
<td>511.2</td>
</tr>
<tr class="odd">
<td>C</td>
<td>D</td>
<td>489.3</td>
</tr>
<tr class="even">
<td>C</td>
<td>D</td>
<td>501.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>E</td>
<td>472.9</td>
</tr>
<tr class="even">
<td>C</td>
<td>E</td>
<td>501.7</td>
</tr>
<tr class="odd">
<td>C</td>
<td>F</td>
<td>504.0</td>
</tr>
<tr class="even">
<td>C</td>
<td>F</td>
<td>508.0</td>
</tr>
</tbody>
</table>
<p>MATLABでグラフを作成しながら順に説明しよう。まずデータを入力する。手入力は時間がかかるので本演習では以下のコマンドを実行する。</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">% データ読み込み</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span> <span class="op">=</span> <span class="st">&quot;https://raw.githubusercontent.com/qikushu/stat/master/anova1.csv&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="va">d</span> <span class="op">=</span> <span class="va">readtable</span>(<span class="va">URL</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">d</span>.<span class="va">Fertilizer</span> <span class="op">=</span> <span class="va">categorical</span>(<span class="va">d</span>.<span class="va">Fertilizer</span>)<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="va">d</span>.<span class="va">Area</span> <span class="op">=</span> <span class="va">categorical</span>(<span class="va">d</span>.<span class="va">Area</span>)<span class="op">;</span></span></code></pre></div>
<p>前回同様、まずは記述統計をおこない、データを俯瞰する。平均値、不偏標本分散を算出する。</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">% 全データの平均値を計算</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="va">mean</span>(<span class="va">d</span>.<span class="va">Yield</span>)  <span class="co">% 509.2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">%　Fertilizer 別の散布図の作成</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="va">scatter</span>(<span class="va">d</span>.<span class="va">Fertilizer</span><span class="op">,</span><span class="va">d</span>.<span class="va">Yield</span>)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">% Fertilizer 別に平均と分散を示す</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="va">statByF</span> <span class="op">=</span> <span class="va">grpstats</span>(<span class="va">d</span><span class="op">,</span> <span class="ss">&#39;Fertilizer&#39;</span><span class="op">,</span> {<span class="ss">&#39;mean&#39;</span><span class="op">,</span> <span class="ss">&#39;var&#39;</span>}<span class="op">,</span> <span class="ss">&#39;DataVars&#39;</span><span class="op">,</span> <span class="ss">&#39;Yield&#39;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">%　Area 別の散布図の作成</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="va">scatter</span>(<span class="va">d</span>.<span class="va">Area</span><span class="op">,</span><span class="va">d</span>.<span class="va">Yield</span>)<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">% Area 別に平均と分散を示す</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="va">statByA</span> <span class="op">=</span> <span class="va">grpstats</span>(<span class="va">d</span><span class="op">,</span> <span class="ss">&#39;Area&#39;</span><span class="op">,</span> {<span class="ss">&#39;mean&#39;</span><span class="op">,</span> <span class="ss">&#39;var&#39;</span>}<span class="op">,</span> <span class="ss">&#39;DataVars&#39;</span><span class="op">,</span> <span class="ss">&#39;Yield&#39;</span>)</span></code></pre></div>
<p><img src="eaxclqpwbi.png" alt="" width="50%"></p>
<p><strong>FertilizerおよびAreaの水準ごとの収量の散布図.
すべての丸印の平均値を黒、各群の平均値を赤で記入しよう。</strong></p>
<h4 id="matlabを用いた分散分析の実行">MATLABを用いた分散分析の実行</h4>
<p>一元配置分散分析を行う。収量<code>Yield</code>を応答変数、有機肥料の種類<code>Fertilizer</code>を独立変数とする。この場合モデル式を用いて
<code>Yield ~ Fertilizer</code>とあらわす。</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d</span><span class="op">,</span> <span class="ss">&#39;Yield ~ Fertilizer&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">anova</span>(<span class="va">mdl</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                 <span class="va">SumSq</span>     <span class="va">DF</span>    <span class="va">MeanSq</span>      <span class="va">F</span>        <span class="va">pValue</span>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Fertilizer</span>    <span class="fl">1600.4</span>     <span class="fl">2</span>     <span class="fl">800.2</span>    <span class="fl">7.3185</span>    <span class="fl">0.0060523</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">Error</span>         <span class="fl">1640.1</span>    <span class="fl">15</span>    <span class="fl">109.34</span>      </span></code></pre></div>
<p>得られた表を<strong>分散分析表</strong>という。Excelでも作成できる。一行目について、DFはdegree
of freedomで<strong>自由度</strong>、SumSqは Sum of
squareで<strong>偏差平方和</strong>、MeanSqはMean
squareで<strong>平均平方</strong>、F <strong><span
class="math inline">\(F\)</span>値</strong>、pValueで<span
class="math inline">\(p\)</span>値のことである。Error
<strong>残差</strong>で、今回は群内誤差を指す。Rの出力結果を下記の表に写し取り、分散分析表を完成させよう。</p>
<p>分散分析表</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th><span class="math inline">\(F\)</span>値</th>
<th><span class="math inline">\(p\)</span>値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(肥料)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<h4 id="分散分析表の作成と検定">分散分析表の作成と検定</h4>
<p>分散分析では(1)群内および群間の平方和より分散を計算し、(2)分散比(<span
class="math inline">\(F\)</span>値)について(3)確率計算を行い、(4)有意性を判定する。</p>
<h4 id="自由度">自由度</h4>
<p>分散の推定値として、標本より推定した不偏分散を用いるため、各平方和を<strong>自由度</strong>にて割って各分散をもとめる。自由度とは、平均値を定数と定めたときに、自由に動ける変数の数のことである。例えば全平均<span
class="math inline">\(\bar{Y}\)</span>は18個のデータから計算されたが、同じ平均値を18個のデータから得ようとしたとき、自由に動けるのは17個のみである。よって、n-1となる。分散分析では、分散は平均平方(mean
square)という。全平方和の自由度は、18-1 =
17である。群間の自由度は、群が3つあるので、3-1=2である。群内の自由度は、18
- 1 - 2 = 15と計算する。</p>
<h4 id="平均平方">平均平方</h4>
<p>平均平方
(分散)は、各平方和を自由度で割って求める。群間の平均平方は<span
class="math inline">\(1600/2=800\)</span>である。群内の平均平方は<span
class="math inline">\(1640/15=109.3\)</span>である。</p>
<h4 id="分散比">分散比</h4>
<p>群間の平均平方(群間の分散)と群内の平均平方(群内の分散)の比を分散比といい、<span
class="math inline">\(F\)</span>とあらわす。F=群間の平均平方 /
群内の平均平方にて求める。よって<span
class="math inline">\(F=800.2/109.3=7.319\)</span></p>
<h4 id="f分布表">F分布表</h4>
<p><span class="math inline">\(F\)</span>値の確率密度分布(<span
class="math inline">\(F\)</span>分布)の上側累積確率に基づく<span
class="math inline">\(p\)</span>値を求める。<span
class="math inline">\(F\)</span>分布は群の自由度、群内の自由度を<span
class="math inline">\(df1\)</span>, <span
class="math inline">\(df2\)</span>により分布の形が変わる。図は<span
class="math inline">\(df1=2, df2=15\)</span>の<span
class="math inline">\(F\)</span>分布である。F=7.319の上側確率を求めよう。</p>
<table>
<thead>
<tr class="header">
<th><img src="aevclqw.png" alt="" width="50%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong><span class="math inline">\(df=1\)</span>, <span
class="math inline">\(df2=15\)</span>における<span
class="math inline">\(F\)</span>分布</strong></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">df1</span> <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="va">df2</span> <span class="op">=</span> <span class="fl">15</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">F</span> <span class="op">=</span> <span class="fl">7.319</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span> <span class="op">-</span> <span class="va">fcdf</span>(<span class="va">F</span><span class="op">,</span> <span class="va">df1</span><span class="op">,</span> <span class="va">df2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1</span>] <span class="fl">0.0163</span></span></code></pre></div>
<p><span class="math inline">\(p= 0.0163 &lt; \alpha
=0.05\)</span>より、帰無仮説(<span
class="math inline">\(H_0\)</span>)を棄却し、対立仮説(<span
class="math inline">\(H_1\)</span>)を採択する。
すなわち収量に対して有機肥料の種類は関連があることが示唆される。</p>
<p>Area についてはどうだろうか。</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d</span><span class="op">,</span> <span class="ss">&#39;Yield ~ Area&#39;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">anova</span>(<span class="va">mdl</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>             <span class="va">SumSq</span>     <span class="va">DF</span>    <span class="va">MeanSq</span>       <span class="va">F</span>       <span class="va">pValue</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">Area</span>     <span class="fl">297.22</span>     <span class="fl">2</span>    <span class="fl">148.61</span>    <span class="fl">0.75738</span>    <span class="fl">0.48601</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Error</span>    <span class="fl">2943.3</span>    <span class="fl">15</span>    <span class="fl">196.22</span>                       </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">verbatim</span>}</span></code></pre></div>
<p><code>Area</code>については、<span
class="math inline">\(p\)</span>値が0.486であり<span
class="math inline">\(p&gt;0.05\)</span>なので、有意ではない、すなわち、収量に対して区画は関連がないことが示唆される。</p>
<p>分散分析表の背景を理解することが、今回の演習の目的である。本演習では、各要因の反復数がすべて同一の「つり合い型(balanced)」の実験デザインにおいて得られたデータに関する解析手法について説明する。各水準ごとの反復数が異なる場合などは、非つり合い型(unbalanced)として、解析を行う必要があるが、本演習では扱わない。</p>
<h2 id="実践編">実践編</h2>
<p>分散分析による要因の分析を行う場合は、複数の要因を同時に考慮する場合が多い。</p>
<h4 id="例題">例題</h4>
<p>表は、2014-2016年(<code>Y2014</code>, <code>Y2015</code>,
<code>Y2016</code>)の三か年(<code>Year</code>)において、水稲三品種(<code>Variety</code>)を東南アジアのモンスーン季(雨季,
<code>MS</code>)と乾季(<code>DS</code>)の作季(<code>Season</code>)にて育成し、穂到日数(<code>HD</code>)を計測したものである。品種、作季が到穂日数に関連があるか調査しなさい。</p>
<p>例題 二元配置分散分析</p>
<table>
<thead>
<tr class="header">
<th>HD</th>
<th>Variety</th>
<th>Season</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>115</td>
<td>M</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="even">
<td>118</td>
<td>M</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="odd">
<td>117</td>
<td>M</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="even">
<td>117</td>
<td>S</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="odd">
<td>116</td>
<td>S</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="even">
<td>116</td>
<td>S</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="odd">
<td>124</td>
<td>Y</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="even">
<td>125</td>
<td>Y</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="odd">
<td>122</td>
<td>Y</td>
<td>DS</td>
<td>Y2014</td>
</tr>
<tr class="even">
<td>113</td>
<td>M</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>115</td>
<td>M</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>112</td>
<td>M</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>117</td>
<td>S</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>116</td>
<td>S</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>117</td>
<td>S</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>115</td>
<td>Y</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>117</td>
<td>Y</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>114</td>
<td>Y</td>
<td>DS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>95</td>
<td>M</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>96</td>
<td>M</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>94</td>
<td>M</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>98</td>
<td>S</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>97</td>
<td>S</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>98</td>
<td>S</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>110</td>
<td>Y</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>108</td>
<td>Y</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="odd">
<td>108</td>
<td>Y</td>
<td>MS</td>
<td>Y2015</td>
</tr>
<tr class="even">
<td>93</td>
<td>M</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="odd">
<td>93</td>
<td>M</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="even">
<td>95</td>
<td>M</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="odd">
<td>91</td>
<td>S</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="even">
<td>93</td>
<td>S</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="odd">
<td>93</td>
<td>S</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="even">
<td>105</td>
<td>Y</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="odd">
<td>107</td>
<td>Y</td>
<td>MS</td>
<td>Y2016</td>
</tr>
<tr class="even">
<td>107</td>
<td>Y</td>
<td>MS</td>
<td>Y2016</td>
</tr>
</tbody>
</table>
<h4 id="解答例">解答例</h4>
<p>到穂日数(<code>HD</code>)を応答変数として、品種(<code>Variety</code>)を要因とする一元配置分散分析、および作季(<code>Season</code>)を説明変数とする一元配置分散分析を行う。まず記述統計を行い、それぞれの要因の水準別に散布図や平均、分散を算出する。</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">% データ読み込み</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="va">URL1</span> <span class="op">=</span> <span class="st">&quot;https://raw.githubusercontent.com/qikushu/stat/master/yieldtrial1.txt&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="va">d1</span> <span class="op">=</span> <span class="va">readtable</span>(<span class="va">URL1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="va">d1</span>.<span class="va">Variety</span> <span class="op">=</span> <span class="va">categorical</span>(<span class="va">d1</span>.<span class="va">Variety</span>)<span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">d1</span>.<span class="va">Season</span> <span class="op">=</span> <span class="va">categorical</span>(<span class="va">d1</span>.<span class="va">Season</span>)<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="va">d1</span>.<span class="va">Year</span> <span class="op">=</span> <span class="va">categorical</span>(<span class="va">d1</span>.<span class="va">Year</span>)<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">%  HDデータをVariety別に分類後に散布図を作図</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">scatter</span>(<span class="va">d1</span>.<span class="va">Variety</span><span class="op">,</span> <span class="va">d1</span>.<span class="va">HD</span>)<span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">% 非連続性があるようにみえる。これはSeasonを考慮しなかった(無視した)ため。</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">% VarietyとSeasonの両方でデータを区分けして示す</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="va">newtype</span> <span class="op">=</span> <span class="va">strcat</span>(<span class="va">cellstr</span>(<span class="va">d1</span>.<span class="va">Season</span>)<span class="op">,</span> <span class="ss">&#39;-&#39;</span><span class="op">,</span> <span class="va">cellstr</span>(<span class="va">d1</span>.<span class="va">Variety</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="va">newtype</span> <span class="op">=</span> <span class="va">categorical</span>(<span class="va">newtype</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="va">d1</span>.<span class="va">newtype</span> <span class="op">=</span> <span class="va">newtype</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">%  HDデータを newtype 別に分類後に散布図を作図</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="va">scatter</span>(<span class="va">d1</span>.<span class="va">newtype</span><span class="op">,</span> <span class="va">d1</span>.<span class="va">HD</span>)<span class="op">;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">% newtype 別に平均と分散を示す</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="va">statByNewtype</span> <span class="op">=</span> <span class="va">grpstats</span>(<span class="va">d1</span><span class="op">,</span> <span class="ss">&#39;newtype&#39;</span><span class="op">,</span> {<span class="ss">&#39;mean&#39;</span><span class="op">,</span> <span class="ss">&#39;var&#39;</span>}<span class="op">,</span> <span class="ss">&#39;DataVars&#39;</span><span class="op">,</span> <span class="ss">&#39;HD&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th><img src="zfau9g.png" alt="" width="50%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>図. 作季ごとに分類した到穂日数の分布</strong></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th><img src="bfsj3pir.png" alt="" width="50%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>図. 作季と品種ごとに分類した到穂日数の分布</strong></td>
</tr>
</tbody>
</table>
<p>モデル式を<code>HD ~ Variety</code>とする一元配置分散分析を行うと、</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d1</span><span class="op">,</span> <span class="ss">&#39;HD ~ Variety&#39;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="va">anova</span>(<span class="va">mdl</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               <span class="va">SumSq</span>     <span class="va">DF</span>    <span class="va">MeanSq</span>      <span class="va">F</span>        <span class="va">pValue</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">Variety</span>    <span class="fl">557.06</span>     <span class="fl">2</span>    <span class="fl">278.53</span>    <span class="fl">2.7786</span>    <span class="fl">0.076689</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Error</span>      <span class="fl">3307.9</span>    <span class="fl">33</span>    <span class="fl">100.24</span>                      </span></code></pre></div>
<p>分散分析表</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(Fertilizer)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>となった。分散分析における帰無仮説(<span
class="math inline">\(H_0\)</span>)は「要因間に目的変数に違いはない」である。一元配置分散分析にて到穂日数と品種の関連を調査したところ、5%水準にて帰無仮説は棄却されなかった。よって品種間に到穂日数に違いがあるとは言えず、到穂日数と品種の関連はない。</p>
<p>モデル式を<code>HD ~ Season</code>とする 一元配置分散分析を行う。</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d1</span><span class="op">,</span> <span class="ss">&#39;HD ~ Season&#39;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="va">anova</span>(<span class="va">mdl</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>              <span class="va">SumSq</span>     <span class="va">DF</span>    <span class="va">MeanSq</span>      <span class="va">F</span>         <span class="va">pValue</span>  </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Season</span>      <span class="fl">2934</span>     <span class="fl">1</span>      <span class="fl">2934</span>    <span class="fl">107.16</span>    <span class="fl">4.7787e-12</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">Error</span>     <span class="fl">930.94</span>    <span class="fl">34</span>    <span class="fl">27.381</span>                               </span></code></pre></div>
<p>分散分析表</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(Season)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>一元配置分散分析にて到穂日数と作季の関連を調査した。帰無仮説(<span
class="math inline">\(H_0\)</span>)は「作季間おいて到穂日数の違いはない」である。分散分析の結果、<span
class="math inline">\(p\)</span>値は<span class="math inline">\(4.779
\times 10 ^ {-12} &lt; \alpha =
0.05\)</span>であり5%水準にて帰無仮説は棄却された。よって作季間において到穂日数の違いがあるといえる。</p>
<p>一元配置分散分析では、到穂日数と品種間の関連は認められなかった。しかしモンスーン季と雨季別に見ると、品種間で到穂日数に違いがあるように見える(図)。観察データの変動に複数の要因が関わっている場合、一元配置分散分析にて一つずつ要因を検討すると、モデルに組み込んでいない要因による変動が残差に残ってしまうため、残差の平均平方が大きくなり、有意差が出にくくなる場合がある。そのような場合には、複数の要因を同時に考慮することで、全変動を積極的に要因に吸収させ、残差の平均平方を減少するように努める。その結果、検出力が向上する場合が多い。そこでモデル式を<code>HD ~ Variety + Season</code>とする二元配置分散分析により、複数の要因を同時に考慮して分散分析を行う。(ただし、<code>Variety</code>と<code>Season</code>は独立と仮定する)。</p>
<p>平方和の計算にはTypeI, II, III, IV,
Vなどがあるが、今回はTypeIIIの平方和に基づく分散分析を行う。最も重要なことは、RのデフォルトではType
I平方和が用いられるが、Type
Iでは説明変数の投入の順番により平方和の値が変化してしまう問題である。Type
IIあるいはIIIではその問題は起こらない。</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">% 二元配置分散分析の例</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d1</span><span class="op">,</span> <span class="ss">&#39;HD ~ Season + Variety&#39;</span>)<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="va">anova</span>(<span class="va">mdl</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">% 結果の表示</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                <span class="va">SumSq</span>     <span class="va">DF</span>    <span class="va">MeanSq</span>      <span class="va">F</span>         <span class="va">pValue</span>  </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">Variety</span>    <span class="fl">557.06</span>     <span class="fl">2</span>    <span class="fl">278.53</span>    <span class="fl">23.838</span>    <span class="fl">4.5825e-07</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">Season</span>       <span class="fl">2934</span>     <span class="fl">1</span>      <span class="fl">2934</span>    <span class="fl">251.11</span>    <span class="fl">1.0505e-16</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">Error</span>      <span class="fl">373.89</span>    <span class="fl">32</span>    <span class="fl">11.684</span> </span></code></pre></div>
<p>分散分析表</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(Season)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群間(Variety)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>上記の結果から、<code>Season</code>と<code>Variety</code>の両方がHDに関連していることが示唆された。幾何的には、<code>HD</code>の変動は、<code>Season</code>の変動と<code>Variety</code>の変動、残差に平方和分解され、球に内接する直方体の形に分解される(図)。</p>
<p><img src="k4mpcho.png" alt="" width="50%"></p>
<p><strong>図. 二元配置分散分析(相互作用無し)</strong></p>
<p><code>Season</code>の平方和は<span
class="math inline">\(2934\)</span>で、<code>MS</code>と<code>DS</code>の二つなので自由度は<span
class="math inline">\(2-1 = 1\)</span>。よって平均平方(mean
square)は<span
class="math inline">\(2934/1=2934\)</span>である。残差平方和は374で自由度が<span
class="math inline">\(32\)</span>より、残差の平均平方は<span
class="math inline">\(374/32=11.68\)</span>、よって<code>Season</code>の群間分散と残差の分散(群内分散)の<span
class="math inline">\(F\)</span>値は<span
class="math inline">\(2934/11.68 = 251.114\)</span>。 自由度1、32の<span
class="math inline">\(F\)</span>分布と照合して、<span
class="math inline">\(F &gt; 251.114\)</span>となる確率は、<span
class="math inline">\(2.2 \times
10^{-16}\)</span>以下であり、有意水準5%より小さい。よって<code>Season</code>は<code>HD</code>と関連がある。同様に、<code>Variety</code>についても<span
class="math inline">\(F\)</span>値が計算され、<span
class="math inline">\(F &gt;23.838\)</span>となる確率は、<span
class="math inline">\(4.582 \times
10^{-7}\)</span>であり、有意水準5%より小さい。よって<code>Variety</code>は<code>HD</code>と関連がある。</p>
<p><code>Variety</code>はone-way
ANOVAでは関連がないように見えたが、<code>Season</code>をモデルに投入することで、<code>Season</code>に由来するノイズが調整され<code>Variety</code>に由来する変動を捉えることができた。<code>Season</code>や<code>Variety</code>のように単一の説明変数が目的変数に対して効果を持つ(関連がある)場合を
<strong>主効果 (main effect)</strong>
という。複数の説明変数の組み合わせにより効果を持つ場合は
<strong>相互作用 (interaction)</strong> といい、次節にて紹介する。</p>
<h4 id="相互作用を考慮する場合">相互作用を考慮する場合</h4>
<p>相互作用を考慮する場合は、以下のように行う。</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d1</span><span class="op">,</span> <span class="ss">&#39;HD ~ Season + Variety + Season : Variety&#39;</span>)<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="va">anova</span>(<span class="va">mdl</span><span class="op">,</span> <span class="ss">&#39;component&#39;</span><span class="op">,</span><span class="fl">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                            <span class="va">SumSq</span>     <span class="va">DF</span>    <span class="va">MeanSq</span>      <span class="va">F</span>         <span class="va">pValue</span>  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">Variety</span>                <span class="fl">557.06</span>     <span class="fl">2</span>    <span class="fl">278.53</span>    <span class="fl">40.204</span>     <span class="fl">3.249e-09</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Season</span>                 <span class="fl">2934</span>     <span class="fl">1</span>      <span class="fl">2934</span>    <span class="fl">423.52</span>     <span class="fl">3.031e-19</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">Variety</span><span class="op">:</span><span class="va">Season</span>    <span class="fl">166.06</span>     <span class="fl">2</span>    <span class="fl">83.028</span>    <span class="fl">11.985</span>    <span class="fl">0.00014948</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">Error</span>                  <span class="fl">207.83</span>    <span class="fl">30</span>    <span class="fl">6.9278</span>   </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a># このような書き方もある</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="va">mdl</span> <span class="op">=</span> <span class="va">fitlm</span>(<span class="va">d1</span><span class="op">,</span> <span class="ss">&#39;HD ~ Season * Variety&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>分散分析表</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(Season)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群間(Variety)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>相互作用(Season:Variety)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>前節と同様、主効果の<code>Season</code>と<code>Variety</code>は有意となり、到穂日数に関連していることが示唆された。<code>Season:Variety</code>が相互作用に相当する成分であり、<code>Season:Variety</code>の相互作用に関する平方和、平均平方、<span
class="math inline">\(F\)</span>値が計算され、<span
class="math inline">\(F\)</span>値に基づく<span
class="math inline">\(p\)</span>値が算出される。</p>
<p>相互作用は何を測っているのだろうか。全データの平均値は<code>mean(allHD) = 107.9722</code>であった。品種Mの平均値は<code>mean(M) =104.666</code>でallHDから104.666
- 107.9722 = -3.3062のズレをもつ。DSの平均値はmean(DS) =
117でallHDから117 - 104.666 =
12.334のずれをもつ。よって品種Mで<code>DS</code>に育成された集団は、107.9722
+ (- 3.3062) + 12.334
=117になると期待される。実際の観測値MDSは115であり、-2ほど低い値である。このずれが相互作用に対応する偏差である。</p>
<p>解析結果を見ると、作季および品種を主効果、作季x品種を相互作用として仮定したモデルにおいて分散分析を行ったところ、作季および品種の相互作用、作季x品種間の相互作用が認められた。</p>
<h3 id="レポート課題">レポート課題</h3>
<p>データを以下のURLからダウンロードする</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="va">myURL</span> <span class="op">=</span> <span class="st">&quot;https://raw.githubusercontent.com/qikushu/stat/master/yieldtrial2ABC.txt&quot;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">d3</span> <span class="op">=</span> <span class="va">read</span>.<span class="va">table</span>(<span class="va">myURL</span><span class="op">,</span> <span class="va">head</span><span class="op">=</span><span class="va">T</span>)</span></code></pre></div>
<p>圃場試験実習において、施肥量(<code>fert</code>)と栽植密度(<code>dens</code>)が水稲収量にもたらす影響を調べられた。圃場を大きく二つのブロックに分割し、各ブロックに12のプロットを設定して行われた。収量(<code>gy</code>)とは、単位面積(m2)あたりの玄米の収穫量(g)のことであるが、収量構成要素は、収量に影響を与える形質で収量を分解したもので、例えば、「単位面積当たりの穂数(<code>pn</code>)」、「一穂籾数(<code>gn</code>)」、「登熟歩合(<code>pr</code>)」、「玄米千粒重(<code>gw</code>)」と分解できる。
収量はこれらの構成要素の積で表現される。下記の質問に答えよ。</p>
<ol type="1">
<li>施肥量(<code>fert</code>)は収量(<code>gy</code>)に影響を与えるといえるか、一元配置分散分析にて5%水準にて検定せよ。分散分析表を作成するとともに、検定の手続きに従って検定の結果と結論を正しく論述すること。(以下おなじ)</li>
<li>栽植密度(<code>dens</code>)は玄米千粒重(<code>gw</code>)に影響を与えるといえるか、一元配置分散分析にて5%水準にて検定せよ。</li>
<li>栽植密度(<code>dens</code>)、施肥量(<code>fert</code>)、ブロック(<code>block</code>)を主効果として、収量(<code>gy</code>)に影響を与えるといえるか。二元配置分散分析にて5%水準にて検定せよ。ただし、相互作用は考慮しない。</li>
<li>栽植密度(<code>dens</code>)、施肥量(<code>fert</code>)、ブロック(<code>block</code>)を主効果、栽植密度(<code>dens</code>)
x
施肥量(<code>fert</code>)の相互作用を考慮した場合、これらは一穂籾数(<code>gn</code>)に影響を与えるといえるか、二元配置分散分析(相互作用あり)を用い、5%水準にて検定せよ。</li>
</ol>
<p>分散分析表1</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(fert)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>分散分析表2</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(dens)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>分散分析表3</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(fert)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群間(dens)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>群間(block)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>分散分析表4</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th>平方和</th>
<th>自由度</th>
<th>平均平方</th>
<th>F値</th>
<th>p値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>群間(fert)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>群間(dens)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>群間(block)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>相互作用(fert:dens)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>群内</td>
<td></td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>全体</td>
<td></td>
<td></td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<h3 id="補足資料-平方和分解">補足資料 (平方和分解)</h3>
<h4 id="偏差の分解">偏差の分解</h4>
<p>例えば、18個の測定値<span class="math inline">\(y_1, y_2,\cdots, y_i,
\cdots, y_{18}\)</span>について考える (図A)。ここで<span
class="math inline">\(y_i\)</span>と全平均<span
class="math inline">\(\bar{y}\)</span>の偏差を <span
class="math display">\[
    d_1 = y_1 - \bar{y}  \\
    d_2 = y_2 - \bar{y}  \\
    \vdots \\
    d_{18} = y_{18} - \bar{y}
\]</span></p>
<p>とおく(図)。<span class="math inline">\(Y=(y_1, \cdots,
y_{18})\)</span>、<span class="math inline">\(D=(d_1, \cdots,
d_{18})\)</span>、<span class="math inline">\(\bar{Y}=(\bar{y}, \bar{y},
\cdots, \bar{y})\)</span>とおくと、<span
class="math inline">\(D=Y-\bar{Y}\)</span>と書ける。</p>
<table>
<thead>
<tr class="header">
<th><img src="q8lh1fwta7.png" alt="" width="70%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>図. 全平均からの偏差を用いたデータの示し方</strong></td>
</tr>
</tbody>
</table>
<p>ここで、群ごとの平均値<span class="math inline">\(M=(m_1, \cdots,
m_1, m_2, \cdots, m_2, m_3,\cdots, m_3)\)</span> を考え、<span
class="math inline">\(D_{\text{群間}} = M-\bar{Y}\)</span>および<span
class="math inline">\(D_{\text{群内}} = Y-M\)</span>とおくと、 <span
class="math display">\[
    D  =Y-\bar{Y} \\
    =M-\bar{Y} + Y - M \\
    = D_{\text{群間}} + D_{\text{群内}}
\]</span> である。$D_{} <span
class="math inline">\(は図Aの青色の部分で表される部分で、群ごとの平均値と全体平均の差をしめす。\)</span>D_{}$は図Bの赤色の部分で表される部分で、群ごとの平均値と各データの差をしめす。</p>
<table>
<thead>
<tr class="header">
<th><img src="nxq1fd9bg7.png" alt="" width="70%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>図. 群間の偏差と群内の偏差</strong></td>
</tr>
</tbody>
</table>
<p>偏差の分解</p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="header">
<th>Fertilizer</th>
<th>Y</th>
<th><span class="math inline">\(\bar{Y}\)</span></th>
<th>M</th>
<th><span class="math inline">\(Y-\bar{Y}\)</span></th>
<th><span class="math inline">\(M-\bar{Y}\)</span></th>
<th><span class="math inline">\(Y-M\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>514.7</td>
<td>509.2</td>
<td>518.1</td>
<td>5.5</td>
<td>8.9</td>
<td>-3.4</td>
</tr>
<tr class="even">
<td>A</td>
<td>509.1</td>
<td>509.2</td>
<td>518.1</td>
<td>-0.1</td>
<td>8.9</td>
<td>-9</td>
</tr>
<tr class="odd">
<td>A</td>
<td>512.2</td>
<td>509.2</td>
<td>518.1</td>
<td>3.0</td>
<td>8.9</td>
<td>-5.9</td>
</tr>
<tr class="even">
<td>A</td>
<td>532.7</td>
<td>509.2</td>
<td>518.1</td>
<td>23.5</td>
<td>8.9</td>
<td>14.6</td>
</tr>
<tr class="odd">
<td>A</td>
<td>517.7</td>
<td>509.2</td>
<td>518.1</td>
<td>8.5</td>
<td>8.9</td>
<td>-0.4</td>
</tr>
<tr class="even">
<td>A</td>
<td>522.2</td>
<td>509.2</td>
<td>518.1</td>
<td>13.0</td>
<td>8.9</td>
<td>4.1</td>
</tr>
<tr class="odd">
<td>B</td>
<td>503.5</td>
<td>509.2</td>
<td>513.35</td>
<td>-5.7</td>
<td>4.15</td>
<td>-9.85</td>
</tr>
<tr class="even">
<td>B</td>
<td>511.0</td>
<td>509.2</td>
<td>513.35</td>
<td>1.8</td>
<td>4.15</td>
<td>-2.35</td>
</tr>
<tr class="odd">
<td>B</td>
<td>525.1</td>
<td>509.2</td>
<td>513.35</td>
<td>15.9</td>
<td>4.15</td>
<td>11.75</td>
</tr>
<tr class="even">
<td>B</td>
<td>504.9</td>
<td>509.2</td>
<td>513.35</td>
<td>-4.3</td>
<td>4.15</td>
<td>-8.45</td>
</tr>
<tr class="odd">
<td>B</td>
<td>524.4</td>
<td>509.2</td>
<td>513.35</td>
<td>15.2</td>
<td>4.15</td>
<td>11.05</td>
</tr>
<tr class="even">
<td>B</td>
<td>511.2</td>
<td>509.2</td>
<td>513.35</td>
<td>2.0</td>
<td>4.15</td>
<td>-2.15</td>
</tr>
<tr class="odd">
<td>C</td>
<td>489.3</td>
<td>509.2</td>
<td>496.15</td>
<td>-19.9</td>
<td>-13.05</td>
<td>-6.85</td>
</tr>
<tr class="even">
<td>C</td>
<td>501.0</td>
<td>509.2</td>
<td>496.15</td>
<td>-8.2</td>
<td>-13.05</td>
<td>4.85</td>
</tr>
<tr class="odd">
<td>C</td>
<td>472.9</td>
<td>509.2</td>
<td>496.15</td>
<td>-36.3</td>
<td>-13.05</td>
<td>-23.25</td>
</tr>
<tr class="even">
<td>C</td>
<td>501.7</td>
<td>509.2</td>
<td>496.15</td>
<td>-7.5</td>
<td>-13.05</td>
<td>5.55</td>
</tr>
<tr class="odd">
<td>C</td>
<td>504.0</td>
<td>509.2</td>
<td>496.15</td>
<td>-5.2</td>
<td>-13.05</td>
<td>7.85</td>
</tr>
<tr class="even">
<td>C</td>
<td>508.0</td>
<td>509.2</td>
<td>496.15</td>
<td>-1.2</td>
<td>-13.05</td>
<td>11.85</td>
</tr>
<tr class="odd">
<td>合計</td>
<td>9165.6</td>
<td>9165.6</td>
<td>9165.6</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<h4 id="偏差平方和の分解">偏差平方和の分解</h4>
<p><span class="math inline">\(D\)</span>をベクトルを用いて <span
class="math display">\[
    \vec{D} = (d_1, d_2,  \cdots , d_{18})
\]</span> と表現し、同様に、<span
class="math inline">\(D_{\text{群間}}\)</span>を<span
class="math inline">\(\vec{G}\)</span>、<span
class="math inline">\(D_{\text{群内}}\)</span>を<span
class="math inline">\(\vec{E}\)</span>とベクトルとおくと、前述の<span
class="math inline">\(D = D_{\text{群間}} + D_{\text{群内}}\)</span>は
<span class="math display">\[
\vec{D} = \vec{G} + \vec{E}
\]</span> とかける。図示すると、下図のように書ける。</p>
<table>
<thead>
<tr class="header">
<th><img src="d3z8e0kqf4.png" alt="" width="70%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>図. 偏差ベクトルの性質</strong></td>
</tr>
</tbody>
</table>
<p>ところで、内積の定義から、 <span class="math display">\[
    \vec{D}\cdot \vec{D} = |\vec{D}||\vec{D}| \cdot cos\theta \\
   = |\vec{D}|^2 \\
\]</span>内積の計算は、$ = d_1^2 + d_2^2 + + d_{18}^2
$にて行うことから、 <span class="math display">\[
    |\vec{D}|^2  =  d_1^2 + d_2^2 + \cdots + d_{18}^2
\]</span>である。これは偏差に関する平方和、すなわち<strong>偏差平方和</strong>
そのものである。そこで、<span class="math inline">\(\vec{D} = \vec{G} +
\vec{E}\)</span>の両辺について、自身の内積をとると、 <span
class="math display">\[
    \vec{D}\cdot \vec{D} = (\vec{G} + \vec{E})(\vec{G} + \vec{E}) \\
     |\vec{D}|^2 = |\vec{G}|^2 +2 \cdot \vec{G} \cdot \vec{E} +
|\vec{E}|^2
\]</span>である。各群の個体数が等しい場合(すなわち釣り合い型実験デザインの場合)、<span
class="math inline">\(\vec{G}\)</span>と<span
class="math inline">\(\vec{E}\)</span>の内積は0になる性質を持っていることから、
<span class="math display">\[
    |\vec{D}|^2 = |\vec{G}|^2 + |\vec{E}|^2
\]</span> が成り立つ。言い換えると</p>
<p>各データ(<span class="math inline">\(Y\)</span>)の平均(<span
class="math inline">\(\bar{Y})\)</span>からの誤差(<span
class="math inline">\(D\)</span>) = 群間誤差(<span
class="math inline">\(D_{\text{群間}}\)</span>)の平方和 + 群内誤差(<span
class="math inline">\(D_{\text{群内}}\)</span>)の平方和</p>
<p>である。これを<strong>平方和分解</strong> という。</p>
<p>各群の個体数が異なる非釣り合い型実験計画の場合に、平方和の調整が必要になるのは、この平方和分解の内、<span
class="math inline">\(\vec{G} \cdot \vec{E} \neq
0\)</span>となるためである。今回の資料では、釣り合い型実験が成り立つような例題を出している。</p>
<p><span class="math inline">\(\vec{G}\)</span>と<span
class="math inline">\(\vec{E}\)</span>は直交することから、<span
class="math inline">\(\vec{G}\)</span>と<span
class="math inline">\(\vec{E}\)</span>の交点は直径が<span
class="math inline">\(|\vec{D}|\)</span>である円の円周上に存在し、$||^2
= ||^2 + ||^2 $(三平方の定理)が成り立つ(図B,
C)。これを実際に計算を行った結果を表に示す。統計ソフトでの計算結果と同じになっていることが確認できる。</p>
<table>
<thead>
<tr class="header">
<th><img src="bf7lto6rae.png" alt="" width="70%"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>図. 要因による寄与率の違い</strong></td>
</tr>
</tbody>
</table>
<p>平方和分解 | Fertilizer | Y | <span
class="math inline">\(\bar{Y}\)</span> | <span
class="math inline">\(M\)</span> | |<span
class="math inline">\(\vec{D}\)</span>| | |<span
class="math inline">\(\vec{G}\)</span>| | |<span
class="math inline">\(\vec{E}\)</span>| | |<span
class="math inline">\(\vec{D}^2\)</span>| | |<span
class="math inline">\(\vec{G}^2\)</span>| | |<span
class="math inline">\(\vec{E}^2\)</span>| |
|————|——-|————|——-|———–|———–|———–|————–|————–|————–| | A | 514.7 | 509.2
| 518.1 | 5.5 | 8.9 | -3.4 | 30.25 | 79.21 | 11.56 | | A | 509.1 | 509.2
| 518.1 | -0.1 | 8.9 | -9 | 0.01 | 79.21 | 81 | | A | 512.2 | 509.2 |
518.1 | 3 | 8.9 | -5.9 | 9 | 79.21 | 34.81 | | A | 532.7 | 509.2 | 518.1
| 23.5 | 8.9 | 14.6 | 552.25 | 79.21 | 213.16 | | A | 517.7 | 509.2 |
518.1 | 8.5 | 8.9 | -0.4 | 72.25 | 79.21 | 0.16 | | A | 522.2 | 509.2 |
518.1 | 13 | 8.9 | 4.1 | 169 | 79.21 | 16.81 | | B | 503.5 | 509.2 |
513.35| -5.7 | 4.15 | -9.85 | 32.49 | 17.2225 | 97.0225 | | B | 511 |
509.2 | 513.35| 1.8 | 4.15 | -2.35 | 3.24 | 17.2225 | 5.5225 | | B |
525.1 | 509.2 | 513.35| 15.9 | 4.15 | 11.75 | 252.81 | 17.2225 |
138.0625 | | B | 504.9 | 509.2 | 513.35| -4.3 | 4.15 | -8.45 | 18.49 |
17.2225 | 71.4025 | | B | 524.4 | 509.2 | 513.35| 15.2 | 4.15 | 11.05 |
231.04 | 17.2225 | 122.1025 | | B | 511.2 | 509.2 | 513.35| 2 | 4.15 |
-2.15 | 4 | 17.2225 | 4.6225 | | C | 489.3 | 509.2 | 496.15| -19.9 |
-13.05 | -6.85 | 396.01 | 170.3025 | 46.9225 | | C | 501 | 509.2 |
496.15| -8.2 | -13.05 | 4.85 | 67.24 | 170.3025 | 23.5225 | | C | 472.9
| 509.2 | 496.15| -36.3 | -13.05 | -23.25 | 1317.69 | 170.3025 |
540.5625 | | C | 501.7 | 509.2 | 496.15| -7.5 | -13.05 | 5.55 | 56.25 |
170.3025 | 30.8025 | | C | 504 | 509.2 | 496.15| -5.2 | -13.05 | 7.85 |
27.04 | 170.3025 | 61.6225 | | C | 508 | 509.2 | 496.15| -1.2 | -13.05 |
11.85 | 1.44 | 170.3025 | 140.4225 | | 合計 | 9165.6| 9165.6 | 9165.6| 0
| 0 | 0 | 3240.5 | 1600.41 | 1640.09 |</p>
<p><span class="math display">\[
    |\vec{D}|^2 = \vec{D} \cdot \vec{D} = d_1^2 + d_2^2 + \cdots +
d_{16}^2 \\
    |\vec{G}|^2 = \vec{G}\cdot \vec{G} = (m_1 - \bar{y})^2 + (m_1 -
\bar{y})^2 + \cdots + (m_3 - \bar{y})^2 \\
    |\vec{E}|^2 = \vec{E} \cdot \vec{E} = (y_1-m_1)^2 + (y_2-m_1)^2 +
\cdots + (y_{16}-m_3)^2
\]</span></p>
<p>ベクトルでの図示と分散分析表の対応を確認しよう。
表の全平方和は図の<span
class="math inline">\(|\vec{D}|^2\)</span>の灰色の正方形の面積で3240、
群間の平方和は水色の正方形の面積で1600、群内平方和(または残差平方和)は赤色の正方形の面積で1640に相当する。</p>
<h4 id="寄与率">寄与率</h4>
<p><span
class="math inline">\(|\vec{G}|^2/|\vec{D}|^2\)</span>を寄与率<span
class="math inline">\(R^2\)</span>といい、寄与率が大きいほど、<span
class="math inline">\(D\)</span>のばらつきが、要因によって説明されていることを示す。肥料を要因として配置した場合、水色の四角が大きく、区画を要因とした場合は水色の四角が小さい。</p>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
